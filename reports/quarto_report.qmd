---
title: "Predicting Renewable Electricity Outputs of Different Countries"
author: "Caden Chan, Neha Menon, Peter Chen & Tak Sripratak"
format: 
    html:
        toc: true
        toc-depth: 2
    pdf:
        toc: true
        toc-depth: 2
bibliography: ../reports/references.bib
execute:
    echo: false
    warning: false
editor: source
---

```{python}
import numpy as np
import pandas as pd
import altair as alt
import csv
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
from sklearn import set_config
from zipfile import ZipFile
from io import BytesIO
import urllib.request as urllib2
from sklearn.metrics import mean_squared_error
from IPython.display import Markdown, display
```

# Summary

As a complex issue, climate change doesn't have a singular cause, though the impacts of burning fossil fuels are significant sources of greenhouse gases and have caused detrimental effects. Our analysis here explores if a subset of renewable energy-related World Development Indicators and a simple linear regression model can be used to predict renewable electricity outputs of countries worldwide. Our analysis created a model with a Root Mean Squared Error (RMSE) score of 23.74. Our model could predict most cases accurately, though some predictions with low accuracy were far from the actual values. Our model predicted some countries would have a negative renewable electricity output, demonstrating the need for a more complex analysis using advanced machine learning methods. By creating an advanced machine learning model, the capabilities of countries to produce more renewable electricity based on their other World Development Indicators can be calculated and used to influence country-specific and global goals and targets.

# Introduction

Over the past few decades, climate change has been thoroughly studied. Climate change most commonly refers to the influx of greenhouse gases (GHG) in our atmosphere, leading to warming temperatures and having a vast range of effects on humans, ecosystems and global health. (@ngeo) Renewable energy sources such as solar, wind, hydroelectric, and geothermal power are crucial for reducing global greenhouse gas emissions and combating climate change. (@nrdc) However, the adoption of renewable energy technology and the output of renewable energy varies significantly across countries due to various factors such as geographical location, technological capabilities, economic conditions, and policy frameworks. (@uoft) In this analysis, we observe if a linear regression model can be used to predict the renewable electricity output of different countries based on other World Development Indicators. As the effects of climate change become more apparent, attention will shift to renewable energy sources and how they can be used to power daily activities necessary to achieve a clean energy world. (@nhm) By conducting this analysis, we identify the factors that may indicate renewable electricity output. These results could be used to influence global policy and set country-specific goals on renewable electricity production that are tailored to country circumstances based on values for World Development Indicators. By understanding these factors better, federal and global policy may focus more on improving these factors, allowing shifts to renewable electricity to be achieved more easily.

The dataset used in this project was sourced from the World Bank's World Development Indicators (WDI) database. (@worldbank) The WDI is the primary World Bank collection of development indicators, compiled from officially recognized international sources. It presents the most current and accurate global development data and includes national, regional and global estimates. For the purpose of this project, the dataset was filtered to include indicators relevant to renewable energy.

# Methods and Results

**Step 1.** Data reading. In the first step, we read the data directly from the link to the zip file containing it and specify which file to use.

**Step 2.** Model selection. We will conduct a regression analysis to predict a numeric variable. A simple linear regression model will be used to adhere to project guidelines and keep the analysis at the level of DSCI 100.

**Step 3.** Specifying constraints for data sample selection. 2015 was chosen as the most recent year for which data on renewable energy production was available for all countries.

**Step 4.** Variable selection. After conducting a preliminary literature review and understanding some factors that may be related to renewable electricity production, the 8 variables below were chosen. Then, we explored the relationships between the 8 chosen variables and the target variable to see if there were pre-existing relationships that may be useful in our model.

**The variables we are interested in are as follows from each country:**
* `Access to electricity (% of population)` (numerical): The percentage of the population with access to electricity.
* `Adjusted net national income (constant 2015 US$)` (numerical): The net national income in constant 2015 US dollars.
* `CO2 emissions (kt)` (numerical): The total amount of CO2 emissions in kilotonnes.
* `Death rate, crude (per 1,000 people)` (numerical): The crude death rate per 1,000 people.
* `Land area (sq. km)` (numerical): The total land area in square kilometers.
* `PM2.5 air pollution, mean annual exposure (micrograms per cubic meter)` (numerical): The mean annual exposure to PM2.5 air pollution in micrograms per cubic meter.
* `Population, total` (numerical): The total population.
* `Renewable energy consumption (% of total final energy consumption)` (numerical): The percentage of renewable energy consumption out of the total final energy consumption.
* `Renewable electricity output (% of total electricity output)` (numerical): The percentage of renewable electricity output out of the total electricity output.

**Step 5.** Exploratory visualization. We visualized all the predictor variables vs the target variable. Once these variables were visualized, it was determined that all the chosen variables would be used in the regression analysis.

**Step 6.** Dataset split. We split the data into a training and testing set. This ensures the golden rule is not violated, where our model is tested on the data that was used to create it, and our scoring metrics are reliable and indicative of the model's performance. Then, the model can be fitted using the training data and tested for performance on the testing data.

**Step 7.** Result report. After fitting the model on the training set and testing on the test set, we found the RMSE score to be 22.15. These results were visualized with the scatter plot showing the relationship between the predicted and actual values of the scatter plot.

```{python}
#| label: tbl-data
#| tbl-cap: Data Structure

URL = urllib2.urlopen("https://databank.worldbank.org/data/download/WDI_CSV.zip").read()
file = ZipFile(BytesIO(URL))
data_csv = file.open("WDIData.csv")
data = pd.read_csv(data_csv)
Markdown(data.head().to_markdown(index = False))
```

```{python}
#This is tidying the data and making it usable for analysis 

#2015 was chosen as it was the most recent year in which there were the most values for the target variable

data1=pd.pivot_table(data, index= 'Country Name', values='2015', columns='Indicator Name')

data1.columns

data1= data1[['Access to electricity (% of population)', 'Adjusted net national income (constant 2015 US$)', 
             'CO2 emissions (kt)', 'Death rate, crude (per 1,000 people)',
              'Land area (sq. km)', 'PM2.5 air pollution, mean annual exposure (micrograms per cubic meter)',
                'Population, total','Renewable energy consumption (% of total final energy consumption)',
             'Renewable electricity output (% of total electricity output)']]

#to keep this at the level of a DSCI100 project, NaN values were replaced with 0 instead of using a Standard Scaler, or another imputer method. 
energy_train, energy_test= train_test_split(data1, train_size=0.75)
data1=data1.fillna(0)
```


```{python}
np.random.seed(14)

#split data into training and testing

energy_train, energy_test= train_test_split(data1, train_size=0.75)

#splitting the x and y columns of the data
energy_train_x= energy_train.drop('Renewable electricity output (% of total electricity output)', axis=1)
energy_train_y= energy_train[["Renewable electricity output (% of total electricity output)"]]

energy_test_x= energy_test.drop('Renewable electricity output (% of total electricity output)', axis=1)
energy_test_y= energy_test[["Renewable electricity output (% of total electricity output)"]]

#making the linear model
lm=LinearRegression()

lm.fit(energy_train_x, energy_train_y)

energy_test_y['predicted']= lm.predict(energy_test_x)

#RSME
energy_RMSE = mean_squared_error(y_true=energy_test_y['Renewable electricity output (% of total electricity output)'],y_pred=energy_test_y["predicted"])**(1/2)

energy_RMSE_round = round(energy_RMSE, 2)
```

![(a-h from left to right on each row). After reading some of the literature, these variables were chosen, and exploratory data analysis was conducted to visualize their relationship with the target variable. Plots d), f), and g) show a weak, positive linear relationship, while plots b), c), e) and h) show no relationship, though they can still be used as predictor variables.](../results/figures/EDA.png){#eda width=70%}

![ A graph showing the relationship between the actual values of renewable electricity output and the models generated predictions of the target variable. A weak positive relationship is observed, showing the model is able to predict some cases.](../results/figures/final_analysis.png){#fig-vis-result width=90%}

# Discussion

To visualize the results of our analysis, the predicted values were plotted against the actual values in @fig-vis-result. If our model were perfect, when observing the plot, we would observe all dots on a line with a 45-degree angle with a slope of 1, meaning that the predicted values would be equal to the actual values. However, the scatter of the points shows slight variation from this ideal, which is expected in real-world data. From a visual assessment, there appears to be a moderate clustering of points along the 45-degree angle, a relatively strong linear relation. The spread of points indicates variability in the accuracy of the predictions across different values of renewable electricity output.

The root mean squared error (RMSE) was calculated to be `{python} energy_RMSE_round`. This metric measures the difference between each predicted and actual value, squares it, finds the mean and takes the square root. The interpretation of this value is `{python} energy_RMSE_round`% since our target variable was measured as the proportion of renewable energy produced (out of 100%). This indicates a modest fit, implying that while the model has some predictive ability, the model does not capture a significant portion of the outcome variability. In addition, it must be noted that the model predicts some values as negative, which shows that the model's limitation as a negative renewable electricity production is not possible. There is room for improvement by incorporating additional variables, employing more complex modelling techniques, or improving data quality. The findings, particularly the model score, suggest a moderate level of predictive power. This has been expected given the complexity of factors influencing renewable electricity outputs in different countries, including economic, geographical, technological, and policy factors, which might not be fully captured by the selected indicators alone.

These findings could be significant for policymakers, energy planners, and researchers interested in understanding the determinants of renewable energy production across different nations. Understanding the factors that influence renewable electricity output can help design more effective policies, make informed investment decisions, and guide future research in renewable energy. It highlights the need for comprehensive strategies that consider a wide range of factors to increase renewable electricity output effectively.

The results from this analysis can lead to the following questions:

- Improving Model Accuracy: How can the model's predictive accuracy be improved? Incorporating more comprehensive data, such as policy indices, technological advancement metrics, and more geographical information, might improve predictions.

- Temporal Analysis: How do trends in renewable electricity output change over time, and what factors drive these trends? An ANOVA longitudinal study could provide insights into the effectiveness of policies and technological progress.

- Impact of Non-traditional Factors: How do non-traditional factors, such as public opinion, international cooperation, and educational levels, impact renewable energy output? Exploring these could provide us with a more holistic understanding of the dynamics at play.


# References
